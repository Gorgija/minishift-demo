#!/bin/bash

set -e

if [ -e "/opt/app-root/etc/generate_container_user" ]; then
  source /opt/app-root/etc/generate_container_user
fi

# Runs the nodejs application server. If the container is run in development mode,
run_node() {
  echo -e "Environment: \n\tNODE_ENV=${NODE_ENV}\n\tCMD=${CMD}"
  if [ -n "$CMD" ]; then
    echo "Running custom start command: $CMD"
    eval $CMD
  else
    echo "Running npm start"
    npm start
  fi
}

run_node
